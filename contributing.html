

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <title>Contributing &mdash; rlberry 0.7.0.post22.dev0+41af351 documentation</title>
  
  <link rel="canonical" href="https://rlberry-py.github.io/rlberry/contributing.html" />

  

  <link rel="stylesheet" href="_static/css/vendor/bootstrap.min.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/sg_gallery.css" type="text/css" />
  <link rel="stylesheet" href="_static/sg_gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="_static/sg_gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="_static/sg_gallery-rendered-html.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
<script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
<script src="_static/jquery.js"></script> 
</head>
<body>


<nav id="navbar" class="sk-docs-navbar navbar navbar-expand-md navbar-light bg-light py-0">
  <div class="container-fluid sk-docs-container px-0">
    <button
      id="sk-navbar-toggler"
      class="navbar-toggler"
      type="button"
      data-toggle="collapse"
      data-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent"
      aria-expanded="false"
      aria-label="Toggle navigation"
    >
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="sk-navbar-collapse collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item">
          <a class="sk-nav-link nav-link" href="index.html">Home</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link" href="installation.html">Install</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link" href="user_guide.html">User Guide</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link" href="auto_examples/index.html">Examples</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link" href="api.html">API</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link" href="changelog.html">Changelog</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link" href="about.html">About</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link" href="https://github.com/rlberry-py/rlberry">GitHub</a>
        </li>
        <!--
        <li class="nav-item dropdown nav-more-item-dropdown">
          <a class="sk-nav-link nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">More</a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          </div>
        </li>-->
    </ul>
      <div id="searchbox" role="search">
          <div class="searchformwrapper">
            <form action="https://duckduckgo.com/">
            <input type="hidden" id="sites" name="sites" value="https://rlberry-py.github.io/rlberry/">
            <input type="search" placeholder="Search &hellip;" value="" name="q" />
            <input class="sk-search-text-btn" type="submit" value="Go" /></form>

          </div>
      </div>
    </div>
  </div>
</nav>
<div class="d-flex" id="sk-doc-wrapper">
    <input type="checkbox" name="sk-toggle-checkbox" id="sk-toggle-checkbox">
    <label id="sk-sidemenu-toggle" class="sk-btn-toggle-toc btn sk-btn-primary" for="sk-toggle-checkbox">Toggle Menu</label>
    <div id="sk-sidebar-wrapper" class="border-right">
      <div class="sk-sidebar-toc-wrapper">
        <div class="sk-sidebar-toc-logo">
        </div>
	<br>
        <div class="alert alert-warning p-1 mb-2" role="alert">

          <p class="text-center mb-0">
          rlberry 0.7.0.post22.dev0+41af351<br/>
          <a href="versions.html">Other versions</a>
          </p>

        </div>
            <div class="sk-sidebar-toc">
              <ul>
<li><a class="reference internal" href="#">Contributing</a><ul>
<li><a class="reference internal" href="#documentation">Documentation</a><ul>
<li><a class="reference internal" href="#building-the-documentation">Building the documentation</a></li>
<li><a class="reference internal" href="#tests">Tests</a></li>
<li><a class="reference internal" href="#guidelines-for-docstring">Guidelines for docstring</a></li>
</ul>
</li>
<li><a class="reference internal" href="#guidelines-for-new-agents">Guidelines for new agents</a></li>
<li><a class="reference internal" href="#agent-code-template">Agent code template</a><ul>
<li><a class="reference internal" href="#implementation-notes">Implementation notes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#guidelines-for-logging">Guidelines for logging</a></li>
</ul>
</li>
</ul>

            </div>
      </div>
    </div>
    <div id="sk-page-content-wrapper">
      <div class="sk-page-content container-fluid body px-md-3" role="main">
        
  <section id="contributing">
<h1>Contributing<a class="headerlink" href="#contributing" title="Permalink to this heading">¶</a></h1>
<p>Currently, we are accepting the following forms of contributions:</p>
<ul class="simple">
<li><p>Bug reports (open
an <a class="reference external" href="https://github.com/rlberry-py/rlberry/issues/new?assignees=&amp;amp;labels=&amp;amp;template=bug_report.md&amp;amp;title=">Issue</a>
indicating your system information, the current behavior, the expected behavior, a standalone code to reproduce the
issue and other information as needed).</p></li>
<li><p>Pull requests for bug fixes.</p></li>
<li><p>Improvements/benchmarks for deep RL agents.</p></li>
<li><p>Documentation improvements.</p></li>
<li><p>New environments.</p></li>
<li><p>New agents.</p></li>
<li><p>…</p></li>
</ul>
<p>Please read the rest of this page for more information on how to contribute to
rlberry and look at our <a class="reference internal" href="beginner_dev_guide.html#dev-guide"><span class="std std-ref">beginner developer guide</span></a> if you have questions
about how to use git, do PR or for more informations about the documentation.</p>
<p>For a PR to be accepted it must pass all the tests when the label ‘ready for review’ is set in the PR. The label ‘ready for review’ trigger additional tests to be done on the PR and should be set when the PR is ready.</p>
<section id="documentation">
<h2>Documentation<a class="headerlink" href="#documentation" title="Permalink to this heading">¶</a></h2>
<p>We are glad to accept any sort of documentation: function docstrings, reStructuredText or markdown documents (like this one), tutorials, examples, etc. reStructuredText and markdown documents live in the source code repository under the docs/ directory.</p>
<section id="building-the-documentation">
<h3>Building the documentation<a class="headerlink" href="#building-the-documentation" title="Permalink to this heading">¶</a></h3>
<p>In the following section, we assume that you are in the main rlberry directory.</p>
<p>Building the documentation requires installing some additional packages:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-sSL<span class="w"> </span>https://install.python-poetry.org<span class="w"> </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>-
poetry<span class="w"> </span>install<span class="w"> </span>--with<span class="w"> </span>dev,doc,torch,extras<span class="w"> </span>--sync
</pre></div>
</div>
<p>To build the documentation, you need to be in the docs folder:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>docs
</pre></div>
</div>
<p>You may only need to generate the full website, without the example gallery:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make
</pre></div>
</div>
<p>The documentation will be generated in the <code class="docutils literal notranslate"><span class="pre">_build/html</span></code> directory. To also generate the example gallery you can use:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make<span class="w"> </span>html
</pre></div>
</div>
<p>This will run all the examples, which takes a while. If you only want to generate a few examples, you can use:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">EXAMPLES_PATTERN</span><span class="o">=</span>your_regex_goes_here<span class="w"> </span>make<span class="w"> </span>html
</pre></div>
</div>
</section>
<section id="tests">
<h3>Tests<a class="headerlink" href="#tests" title="Permalink to this heading">¶</a></h3>
<p>We use <code class="docutils literal notranslate"><span class="pre">pytest</span></code> for testing purpose. We cover two types of test: the coverage tests that check that every algorithm does what is intended using as little computer resources as possible and what we call long tests. The long tests are here to test the performance of our algorithms. These tests are too long to be run on the azure pipeline and hence they are not run automatically at each PR. Instead they can be launched locally to check that the main algorithms of rlberry perform as efficiently as previous implementation.</p>
<p>Running tests from root of repository:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>.
</pre></div>
</div>
<p>Running long tests:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>-s<span class="w"> </span>long_tests/**/ltest*.py
</pre></div>
</div>
<p>Tests files must be named <code class="docutils literal notranslate"><span class="pre">test_[something]</span></code> and belong to one of the <code class="docutils literal notranslate"><span class="pre">tests</span></code> directory. Long test files must be names  <code class="docutils literal notranslate"><span class="pre">ltest_[something]</span></code> and belong to the <code class="docutils literal notranslate"><span class="pre">long_tests</span></code> directory.</p>
</section>
<section id="guidelines-for-docstring">
<h3>Guidelines for docstring<a class="headerlink" href="#guidelines-for-docstring" title="Permalink to this heading">¶</a></h3>
<p>Please follow the <a class="reference external" href="https://numpydoc.readthedocs.io/en/latest/format.html">numpydoc docstring guide</a>, the minimal requirements should be to include the short description, parameters and  return section of the docstring.</p>
</section>
</section>
<section id="guidelines-for-new-agents">
<h2>Guidelines for new agents<a class="headerlink" href="#guidelines-for-new-agents" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Create a folder for the agent <code class="docutils literal notranslate"><span class="pre">rlberry/agents/agent_name</span></code>.</p></li>
<li><p>Create <code class="docutils literal notranslate"><span class="pre">rlberry/agents/agent_name/__init__.py</span></code>.</p></li>
<li><p>Write a test to check that the agent is running <code class="docutils literal notranslate"><span class="pre">rlberry/agents/test_agent_name.py</span></code>.</p></li>
<li><p>Write an example <code class="docutils literal notranslate"><span class="pre">examples/demo_agent_name.py</span></code>.</p></li>
</ul>
</section>
<section id="agent-code-template">
<h2>Agent code template<a class="headerlink" href="#agent-code-template" title="Permalink to this heading">¶</a></h2>
<p>The template below gives the general structure that the Agent code must follow. See more options in the abstract <code class="docutils literal notranslate"><span class="pre">Agent</span></code>
class (<code class="docutils literal notranslate"><span class="pre">rlberry/agents/agent.py</span></code>).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyAgent</span><span class="p">(</span><span class="n">Agent</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;MyAgent&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">param_1</span><span class="p">,</span> <span class="n">param_2</span><span class="p">,</span> <span class="n">param_n</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">Agent</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">budget</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ** Must be implemented. **</span>

<span class="sd">        Trains the agent, given a computational budget (e.g. number of steps or episodes).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># code to train the agent</span>
        <span class="c1"># ...</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ** Must be implemented. **</span>

<span class="sd">        Evaluates the agent (e.g. Monte-Carlo policy evaluation).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">0.0</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">sample_parameters</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">trial</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ** Optional **</span>

<span class="sd">        Sample hyperparameters for hyperparam optimization using</span>
<span class="sd">        Optuna (https://optuna.org/).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        trial: optuna.trial</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Note: param_1 and param_2 are in the constructor.</span>

        <span class="c1"># for example, param_1 could be the batch_size...</span>
        <span class="n">param_1</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_categorical</span><span class="p">(</span><span class="s2">&quot;param_1&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">])</span>
        <span class="c1"># ... and param_2 could be a learning_rate</span>
        <span class="n">param_2</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;param_2&quot;</span><span class="p">,</span> <span class="mf">1e-5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;param_1&quot;</span><span class="p">:</span> <span class="n">param_1</span><span class="p">,</span>
            <span class="s2">&quot;param_2&quot;</span><span class="p">:</span> <span class="n">param_2</span><span class="p">,</span>
        <span class="p">}</span>
</pre></div>
</div>
<section id="implementation-notes">
<h3>Implementation notes<a class="headerlink" href="#implementation-notes" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>When inheriting from the <code class="docutils literal notranslate"><span class="pre">Agent</span></code> class, make sure to call <code class="docutils literal notranslate"><span class="pre">Agent.__init__(self,</span> <span class="pre">env,</span> <span class="pre">**kwargs)</span></code> using <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> in
case new features are added to the base class.</p></li>
</ul>
<p>Infos, errors and warnings are printed using the <code class="docutils literal notranslate"><span class="pre">logging</span></code> library.</p>
<ul class="simple">
<li><p>From <code class="docutils literal notranslate"><span class="pre">gym</span></code> to <code class="docutils literal notranslate"><span class="pre">rlberry</span></code>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">reseed</span></code> (rlberry) should be called instead of <code class="docutils literal notranslate"><span class="pre">seed</span></code> (gym). <code class="docutils literal notranslate"><span class="pre">seed</span></code> keeps compatibility with gym, whereas <code class="docutils literal notranslate"><span class="pre">reseed</span></code>
uses the unified seeding mechanism of <code class="docutils literal notranslate"><span class="pre">rlberry</span></code>.</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="guidelines-for-logging">
<h2>Guidelines for logging<a class="headerlink" href="#guidelines-for-logging" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">logger.info()</span></code>, <code class="docutils literal notranslate"><span class="pre">logger.warning()</span></code> and <code class="docutils literal notranslate"><span class="pre">logger.error()</span></code> should be used inside the <code class="docutils literal notranslate"><span class="pre">rlberry</span></code> package, rather
than <code class="docutils literal notranslate"><span class="pre">print()</span></code>.</p></li>
<li><p>The desired level of verbosity can be chosen by calling <code class="docutils literal notranslate"><span class="pre">set_level</span></code>, e.g.:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rlberry.utils.logging</span> <span class="kn">import</span> <span class="n">set_level</span>

<span class="n">set_level</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s2">&quot;DEBUG&quot;</span><span class="p">)</span>
<span class="n">set_level</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s2">&quot;INFO&quot;</span><span class="p">)</span>
<span class="c1"># etc</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">print()</span></code> statements can be used outside <code class="docutils literal notranslate"><span class="pre">rlberry</span></code>, e.g., in scripts and notebooks.</p></li>
</ul>
</section>
</section>


      </div>
    <div class="container">
      <footer class="sk-content-footer">
            &copy; 2023, rlberry team.
          <a href="_sources/contributing.md.txt" rel="nofollow">Show this page source</a>
      </footer>
    </div>
  </div>
</div>
<script src="_static/js/vendor/bootstrap.min.js"></script>

<script>
    window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
    ga('create', 'UA-22606712-2', 'auto');
    ga('set', 'anonymizeIp', true);
    ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


<script>
$(document).ready(function() {
    /* Add a [>>>] button on the top-right corner of code samples to hide
     * the >>> and ... prompts and the output and thus make the code
     * copyable. */
    var div = $('.highlight-python .highlight,' +
                '.highlight-python3 .highlight,' +
                '.highlight-pycon .highlight,' +
		'.highlight-default .highlight')
    var pre = div.find('pre');

    // get the styles from the current theme
    pre.parent().parent().css('position', 'relative');
    var hide_text = 'Hide prompts and outputs';
    var show_text = 'Show prompts and outputs';

    // create and add the button to all the code blocks that contain >>>
    div.each(function(index) {
        var jthis = $(this);
        if (jthis.find('.gp').length > 0) {
            var button = $('<span class="copybutton">&gt;&gt;&gt;</span>');
            button.attr('title', hide_text);
            button.data('hidden', 'false');
            jthis.prepend(button);
        }
        // tracebacks (.gt) contain bare text elements that need to be
        // wrapped in a span to work with .nextUntil() (see later)
        jthis.find('pre:has(.gt)').contents().filter(function() {
            return ((this.nodeType == 3) && (this.data.trim().length > 0));
        }).wrap('<span>');
    });

    // define the behavior of the button when it's clicked
    $('.copybutton').click(function(e){
        e.preventDefault();
        var button = $(this);
        if (button.data('hidden') === 'false') {
            // hide the code output
            button.parent().find('.go, .gp, .gt').hide();
            button.next('pre').find('.gt').nextUntil('.gp, .go').css('visibility', 'hidden');
            button.css('text-decoration', 'line-through');
            button.attr('title', show_text);
            button.data('hidden', 'true');
        } else {
            // show the code output
            button.parent().find('.go, .gp, .gt').show();
            button.next('pre').find('.gt').nextUntil('.gp, .go').css('visibility', 'visible');
            button.css('text-decoration', 'none');
            button.attr('title', hide_text);
            button.data('hidden', 'false');
        }
    });

	/*** Add permalink buttons next to glossary terms ***/
	$('dl.glossary > dt[id]').append(function() {
		return ('<a class="headerlink" href="#' +
			    this.getAttribute('id') +
			    '" title="Permalink to this term">¶</a>');
	});
  /*** Hide navbar when scrolling down ***/
  // Returns true when headerlink target matches hash in url
  (function() {
    hashTargetOnTop = function() {
        var hash = window.location.hash;
        if ( hash.length < 2 ) { return false; }

        var target = document.getElementById( hash.slice(1) );
        if ( target === null ) { return false; }

        var top = target.getBoundingClientRect().top;
        return (top < 2) && (top > -2);
    };

    // Hide navbar on load if hash target is on top
    var navBar = document.getElementById("navbar");
    var navBarToggler = document.getElementById("sk-navbar-toggler");
    var navBarHeightHidden = "-" + navBar.getBoundingClientRect().height + "px";
    var $window = $(window);

    hideNavBar = function() {
        navBar.style.top = navBarHeightHidden;
    };

    showNavBar = function() {
        navBar.style.top = "0";
    }

    if (hashTargetOnTop()) {
        hideNavBar()
    }

    var prevScrollpos = window.pageYOffset;
    hideOnScroll = function(lastScrollTop) {
        if (($window.width() < 768) && (navBarToggler.getAttribute("aria-expanded") === 'true')) {
            return;
        }
        if (lastScrollTop > 2 && (prevScrollpos <= lastScrollTop) || hashTargetOnTop()){
            hideNavBar()
        } else {
            showNavBar()
        }
        prevScrollpos = lastScrollTop;
    };

    /*** high performance scroll event listener***/
    var raf = window.requestAnimationFrame ||
        window.webkitRequestAnimationFrame ||
        window.mozRequestAnimationFrame ||
        window.msRequestAnimationFrame ||
        window.oRequestAnimationFrame;
    var lastScrollTop = $window.scrollTop();

    if (raf) {
        loop();
    }

    function loop() {
        var scrollTop = $window.scrollTop();
        if (lastScrollTop === scrollTop) {
            raf(loop);
            return;
        } else {
            lastScrollTop = scrollTop;
            hideOnScroll(lastScrollTop);
            raf(loop);
        }
    }
  })();
});

</script>
    
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    
</body>
</html>